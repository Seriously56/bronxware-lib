-- Custom UI Library by Nova
-- Fully customizable modern interface

local CustomUILibrary = {}
CustomUILibrary.__index = CustomUILibrary

-- Services
local TweenService = game:GetService("TweenService")
local UserInputService = game:GetService("UserInputService")
local RunService = game:GetService("RunService")

-- Default Theme
local DefaultTheme = {
    Primary = Color3.fromRGB(99, 59, 255),
    Secondary = Color3.fromRGB(149, 109, 255),
    Background = Color3.fromRGB(20, 20, 25),
    Surface = Color3.fromRGB(30, 30, 38),
    Card = Color3.fromRGB(40, 40, 50),
    Text = Color3.fromRGB(240, 240, 245),
    TextSecondary = Color3.fromRGB(180, 180, 190),
    Success = Color3.fromRGB(76, 175, 80),
    Warning = Color3.fromRGB(255, 152, 0),
    Error = Color3.fromRGB(244, 67, 54)
}

function CustomUILibrary:CreateWindow(config)
    local Window = {}
    Window.Tabs = {}
    Window.Theme = config.Theme or DefaultTheme
    
    -- Create Main GUI
    local ScreenGui = Instance.new("ScreenGui")
    ScreenGui.Name = "NovaUI"
    ScreenGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling
    ScreenGui.Parent = game.CoreGui
    
    -- Main Container
    local MainFrame = Instance.new("Frame")
    MainFrame.Name = "Main"
    MainFrame.Size = UDim2.new(0, 500, 0, 450)
    MainFrame.Position = UDim2.new(0.5, -250, 0.5, -225)
    MainFrame.BackgroundColor3 = Window.Theme.Background
    MainFrame.BorderSizePixel = 0
    MainFrame.ClipsDescendants = true
    
    local UICorner = Instance.new("UICorner")
    UICorner.CornerRadius = UDim.new(0, 12)
    UICorner.Parent = MainFrame
    
    local UIStroke = Instance.new("UIStroke")
    UIStroke.Color = Window.Theme.Surface
    UIStroke.Thickness = 2
    UIStroke.Parent = MainFrame
    
    -- Header
    local Header = Instance.new("Frame")
    Header.Name = "Header"
    Header.Size = UDim2.new(1, 0, 0, 50)
    Header.BackgroundColor3 = Window.Theme.Surface
    Header.BorderSizePixel = 0
    
    local HeaderCorner = Instance.new("UICorner")
    HeaderCorner.CornerRadius = UDim.new(0, 12)
    HeaderCorner.Parent = Header
    
    local Title = Instance.new("TextLabel")
    Title.Name = "Title"
    Title.Size = UDim2.new(0, 200, 1, 0)
    Title.Position = UDim2.new(0, 20, 0, 0)
    Title.BackgroundTransparency = 1
    Title.Text = config.Title or "Nova UI"
    Title.TextColor3 = Window.Theme.Text
    Title.TextSize = 18
    Title.Font = Enum.Font.GothamBold
    Title.TextXAlignment = Enum.TextXAlignment.Left
    
    -- Close Button
    local CloseButton = Instance.new("TextButton")
    CloseButton.Name = "Close"
    CloseButton.Size = UDim2.new(0, 30, 0, 30)
    CloseButton.Position = UDim2.new(1, -40, 0.5, -15)
    CloseButton.BackgroundColor3 = Window.Theme.Error
    CloseButton.Text = "Ã—"
    CloseButton.TextColor3 = Window.Theme.Text
    CloseButton.TextSize = 20
    CloseButton.Font = Enum.Font.GothamBold
    CloseButton.BorderSizePixel = 0
    
    local CloseCorner = Instance.new("UICorner")
    CloseCorner.CornerRadius = UDim.new(0, 8)
    CloseCorner.Parent = CloseButton
    
    -- Tab Container
    local TabContainer = Instance.new("Frame")
    TabContainer.Name = "TabContainer"
    TabContainer.Size = UDim2.new(1, -40, 0, 40)
    TabContainer.Position = UDim2.new(0, 20, 0, 60)
    TabContainer.BackgroundTransparency = 1
    
    local TabListLayout = Instance.new("UIListLayout")
    TabListLayout.FillDirection = Enum.FillDirection.Horizontal
    TabListLayout.Padding = UDim.new(0, 8)
    TabListLayout.Parent = TabContainer
    
    -- Content Area
    local ContentFrame = Instance.new("Frame")
    ContentFrame.Name = "Content"
    ContentFrame.Size = UDim2.new(1, -40, 1, -120)
    ContentFrame.Position = UDim2.new(0, 20, 0, 110)
    ContentFrame.BackgroundTransparency = 1
    ContentFrame.ClipsDescendants = true
    
    -- Parent everything
    Header.Parent = MainFrame
    Title.Parent = Header
    CloseButton.Parent = Header
    TabContainer.Parent = MainFrame
    ContentFrame.Parent = MainFrame
    MainFrame.Parent = ScreenGui
    
    -- Make draggable
    local dragging = false
    local dragInput, dragStart, startPos
    
    Header.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 then
            dragging = true
            dragStart = input.Position
            startPos = MainFrame.Position
            
            input.Changed:Connect(function()
                if input.UserInputState == Enum.UserInputState.End then
                    dragging = false
                end
            end)
        end
    end)
    
    Header.InputChanged:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseMovement then
            dragInput = input
        end
    end)
    
    UserInputService.InputChanged:Connect(function(input)
        if input == dragInput and dragging then
            local delta = input.Position - dragStart
            MainFrame.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
        end
    end)
    
    -- Close functionality
    CloseButton.MouseButton1Click:Connect(function()
        ScreenGui:Destroy()
    end)
    
    CloseButton.MouseEnter:Connect(function()
        TweenService:Create(CloseButton, TweenInfo.new(0.2), {BackgroundColor3 = Color3.fromRGB(200, 60, 50)}):Play()
    end)
    
    CloseButton.MouseLeave:Connect(function()
        TweenService:Create(CloseButton, TweenInfo.new(0.2), {BackgroundColor3 = Window.Theme.Error}):Play()
    end)
    
    -- Tab functions
    function Window:CreateTab(tabName, tabIcon)
        local Tab = {}
        
        -- Tab Button
        local TabButton = Instance.new("TextButton")
        TabButton.Name = tabName
        TabButton.Size = UDim2.new(0, 100, 1, 0)
        TabButton.BackgroundColor3 = Window.Theme.Card
        TabButton.Text = tabName
        TabButton.TextColor3 = Window.Theme.TextSecondary
        TabButton.TextSize = 14
        TabButton.Font = Enum.Font.GothamSemibold
        TabButton.BorderSizePixel = 0
        
        local TabCorner = Instance.new("UICorner")
        TabCorner.CornerRadius = UDim.new(0, 8)
        TabCorner.Parent = TabButton
        
        -- Tab Content
        local TabContent = Instance.new("ScrollingFrame")
        TabContent.Name = tabName
        TabContent.Size = UDim2.new(1, 0, 1, 0)
        TabContent.BackgroundTransparency = 1
        TabContent.ScrollBarThickness = 3
        TabContent.ScrollBarImageColor3 = Window.Theme.Primary
        TabContent.Visible = false
        
        local TabContentLayout = Instance.new("UIListLayout")
        TabContentLayout.Padding = UDim.new(0, 10)
        TabContentLayout.Parent = TabContent
        
        -- Parent elements
        TabButton.Parent = TabContainer
        TabContent.Parent = ContentFrame
        
        -- Tab selection
        TabButton.MouseButton1Click:Connect(function()
            for _, content in pairs(ContentFrame:GetChildren()) do
                if content:IsA("ScrollingFrame") then
                    content.Visible = false
                end
            end
            
            for _, button in pairs(TabContainer:GetChildren()) do
                if button:IsA("TextButton") then
                    TweenService:Create(button, TweenInfo.new(0.3), {
                        BackgroundColor3 = Window.Theme.Card,
                        TextColor3 = Window.Theme.TextSecondary
                    }):Play()
                end
            end
            
            TabContent.Visible = true
            TweenService:Create(TabButton, TweenInfo.new(0.3), {
                BackgroundColor3 = Window.Theme.Primary,
                TextColor3 = Window.Theme.Text
            }):Play()
        end)
        
        -- Make first tab active by default
        if #TabContainer:GetChildren() == 2 then -- First tab after UIListLayout
            TabButton.MouseButton1Click:Fire()
        end
        
        -- Element creation functions
        function Tab:CreateSection(title)
            local Section = Instance.new("Frame")
            Section.Name = "Section"
            Section.Size = UDim2.new(1, 0, 0, 40)
            Section.BackgroundTransparency = 1
            
            local SectionTitle = Instance.new("TextLabel")
            SectionTitle.Name = "Title"
            SectionTitle.Size = UDim2.new(1, 0, 1, 0)
            SectionTitle.BackgroundTransparency = 1
            SectionTitle.Text = string.upper(title)
            SectionTitle.TextColor3 = Window.Theme.TextSecondary
            SectionTitle.TextSize = 12
            SectionTitle.Font = Enum.Font.GothamBold
            SectionTitle.TextXAlignment = Enum.TextXAlignment.Left
            
            SectionTitle.Parent = Section
            Section.Parent = TabContent
            
            return Section
        end
        
        function Tab:CreateButton(config)
            local Button = Instance.new("TextButton")
            Button.Name = config.Name
            Button.Size = UDim2.new(1, 0, 0, 40)
            Button.BackgroundColor3 = Window.Theme.Card
            Button.Text = config.Name
            Button.TextColor3 = Window.Theme.Text
            Button.TextSize = 14
            Button.Font = Enum.Font.GothamSemibold
            Button.BorderSizePixel = 0
            
            local ButtonCorner = Instance.new("UICorner")
            ButtonCorner.CornerRadius = UDim.new(0, 8)
            ButtonCorner.Parent = Button
            
            Button.MouseButton1Click:Connect(function()
                local success, err = pcall(config.Callback)
                if not success then
                    warn("Button Error:", err)
                end
            end)
            
            Button.MouseEnter:Connect(function()
                TweenService:Create(Button, TweenInfo.new(0.2), {
                    BackgroundColor3 = Window.Theme.Surface
                }):Play()
            end)
            
            Button.MouseLeave:Connect(function()
                TweenService:Create(Button, TweenInfo.new(0.2), {
                    BackgroundColor3 = Window.Theme.Card
                }):Play()
            end)
            
            Button.Parent = TabContent
            
            return Button
        end
        
        function Tab:CreateToggle(config)
            local Toggle = Instance.new("Frame")
            Toggle.Name = config.Name
            Toggle.Size = UDim2.new(1, 0, 0, 40)
            Toggle.BackgroundColor3 = Window.Theme.Card
            Toggle.BorderSizePixel = 0
            
            local ToggleCorner = Instance.new("UICorner")
            ToggleCorner.CornerRadius = UDim.new(0, 8)
            ToggleCorner.Parent = Toggle
            
            local ToggleLabel = Instance.new("TextLabel")
            ToggleLabel.Name = "Label"
            ToggleLabel.Size = UDim2.new(0.7, 0, 1, 0)
            ToggleLabel.Position = UDim2.new(0, 15, 0, 0)
            ToggleLabel.BackgroundTransparency = 1
            ToggleLabel.Text = config.Name
            ToggleLabel.TextColor3 = Window.Theme.Text
            ToggleLabel.TextSize = 14
            ToggleLabel.Font = Enum.Font.GothamSemibold
            ToggleLabel.TextXAlignment = Enum.TextXAlignment.Left
            
            local ToggleButton = Instance.new("TextButton")
            ToggleButton.Name = "Toggle"
            ToggleButton.Size = UDim2.new(0, 50, 0, 24)
            ToggleButton.Position = UDim2.new(1, -65, 0.5, -12)
            ToggleButton.BackgroundColor3 = Window.Theme.Surface
            ToggleButton.Text = ""
            ToggleButton.BorderSizePixel = 0
            
            local ToggleButtonCorner = Instance.new("UICorner")
            ToggleButtonCorner.CornerRadius = UDim.new(1, 0)
            ToggleButtonCorner.Parent = ToggleButton
            
            local ToggleKnob = Instance.new("Frame")
            ToggleKnob.Name = "Knob"
            ToggleKnob.Size = UDim2.new(0, 20, 0, 20)
            ToggleKnob.Position = UDim2.new(0, 2, 0.5, -10)
            ToggleKnob.BackgroundColor3 = Window.Theme.Text
            ToggleKnob.BorderSizePixel = 0
            
            local ToggleKnobCorner = Instance.new("UICorner")
            ToggleKnobCorner.CornerRadius = UDim.new(1, 0)
            ToggleKnobCorner.Parent = ToggleKnob
            
            -- Set initial state
            local isToggled = config.Default or false
            if isToggled then
                TweenService:Create(ToggleButton, TweenInfo.new(0.2), {
                    BackgroundColor3 = Window.Theme.Success
                }):Play()
                TweenService:Create(ToggleKnob, TweenInfo.new(0.2), {
                    Position = UDim2.new(1, -22, 0.5, -10)
                }):Play()
            end
            
            ToggleButton.MouseButton1Click:Connect(function()
                isToggled = not isToggled
                
                if isToggled then
                    TweenService:Create(ToggleButton, TweenInfo.new(0.2), {
                        BackgroundColor3 = Window.Theme.Success
                    }):Play()
                    TweenService:Create(ToggleKnob, TweenInfo.new(0.2), {
                        Position = UDim2.new(1, -22, 0.5, -10)
                    }):Play()
                else
                    TweenService:Create(ToggleButton, TweenInfo.new(0.2), {
                        BackgroundColor3 = Window.Theme.Surface
                    }):Play()
                    TweenService:Create(ToggleKnob, TweenInfo.new(0.2), {
                        Position = UDim2.new(0, 2, 0.5, -10)
                    }):Play()
                end
                
                local success, err = pcall(config.Callback, isToggled)
                if not success then
                    warn("Toggle Error:", err)
                end
            end)
            
            -- Parent elements
            ToggleLabel.Parent = Toggle
            ToggleKnob.Parent = ToggleButton
            ToggleButton.Parent = Toggle
            Toggle.Parent = TabContent
            
            return Toggle
        end
        
        function Tab:CreateSlider(config)
            local Slider = Instance.new("Frame")
            Slider.Name = config.Name
            Slider.Size = UDim2.new(1, 0, 0, 60)
            Slider.BackgroundColor3 = Window.Theme.Card
            Slider.BorderSizePixel = 0
            
            local SliderCorner = Instance.new("UICorner")
            SliderCorner.CornerRadius = UDim.new(0, 8)
            SliderCorner.Parent = Slider
            
            local SliderLabel = Instance.new("TextLabel")
            SliderLabel.Name = "Label"
            SliderLabel.Size = UDim2.new(1, -30, 0, 20)
            SliderLabel.Position = UDim2.new(0, 15, 0, 5)
            SliderLabel.BackgroundTransparency = 1
            SliderLabel.Text = config.Name
            SliderLabel.TextColor3 = Window.Theme.Text
            SliderLabel.TextSize = 14
            SliderLabel.Font = Enum.Font.GothamSemibold
            SliderLabel.TextXAlignment = Enum.TextXAlignment.Left
            
            local SliderValue = Instance.new("TextLabel")
            SliderValue.Name = "Value"
            SliderValue.Size = UDim2.new(0, 50, 0, 20)
            SliderValue.Position = UDim2.new(1, -65, 0, 5)
            SliderValue.BackgroundTransparency = 1
            SliderValue.Text = tostring(config.Value or config.Min)
            SliderValue.TextColor3 = Window.Theme.TextSecondary
            SliderValue.TextSize = 14
            SliderValue.Font = Enum.Font.GothamSemibold
            SliderValue.TextXAlignment = Enum.TextXAlignment.Right
            
            local SliderTrack = Instance.new("Frame")
            SliderTrack.Name = "Track"
            SliderTrack.Size = UDim2.new(1, -30, 0, 6)
            SliderTrack.Position = UDim2.new(0, 15, 1, -25)
            SliderTrack.BackgroundColor3 = Window.Theme.Surface
            SliderTrack.BorderSizePixel = 0
            
            local SliderTrackCorner = Instance.new("UICorner")
            SliderTrackCorner.CornerRadius = UDim.new(1, 0)
            SliderTrackCorner.Parent = SliderTrack
            
            local SliderFill = Instance.new("Frame")
            SliderFill.Name = "Fill"
            SliderFill.Size = UDim2.new(0, 0, 1, 0)
            SliderFill.BackgroundColor3 = Window.Theme.Primary
            SliderFill.BorderSizePixel = 0
            
            local SliderFillCorner = Instance.new("UICorner")
            SliderFillCorner.CornerRadius = UDim.new(1, 0)
            SliderFillCorner.Parent = SliderFill
            
            local SliderThumb = Instance.new("TextButton")
            SliderThumb.Name = "Thumb"
            SliderThumb.Size = UDim2.new(0, 16, 0, 16)
            SliderThumb.Position = UDim2.new(0, -8, 0.5, -8)
            SliderThumb.BackgroundColor3 = Window.Theme.Text
            SliderThumb.Text = ""
            SliderThumb.BorderSizePixel = 0
            
            local SliderThumbCorner = Instance.new("UICorner")
            SliderThumbCorner.CornerRadius = UDim.new(1, 0)
            SliderThumbCorner.Parent = SliderThumb
            
            -- Initialize
            local min = config.Min or 0
            local max = config.Max or 100
            local current = config.Value or min
            
            local function updateSlider(value)
                current = math.clamp(value, min, max)
                local percentage = (current - min) / (max - min)
                
                SliderValue.Text = tostring(math.floor(current))
                SliderFill.Size = UDim2.new(percentage, 0, 1, 0)
                SliderThumb.Position = UDim2.new(percentage, -8, 0.5, -8)
                
                local success, err = pcall(config.Callback, current)
                if not success then
                    warn("Slider Error:", err)
                end
            end
            
            updateSlider(current)
            
            -- Dragging logic
            local dragging = false
            
            SliderThumb.MouseButton1Down:Connect(function()
                dragging = true
            end)
            
            UserInputService.InputEnded:Connect(function(input)
                if input.UserInputType == Enum.UserInputType.MouseButton1 then
                    dragging = false
                end
            end)
            
            SliderTrack.InputBegan:Connect(function(input)
                if input.UserInputType == Enum.UserInputType.MouseButton1 then
                    dragging = true
                    local percentage = (input.Position.X - SliderTrack.AbsolutePosition.X) / SliderTrack.AbsoluteSize.X
                    updateSlider(min + percentage * (max - min))
                end
            end)
            
            UserInputService.InputChanged:Connect(function(input)
                if dragging and input.UserInputType == Enum.UserInputType.MouseMovement then
                    local percentage = (input.Position.X - SliderTrack.AbsolutePosition.X) / SliderTrack.AbsoluteSize.X
                    updateSlider(min + percentage * (max - min))
                end
            end)
            
            -- Parent elements
            SliderFill.Parent = SliderTrack
            SliderThumb.Parent = SliderTrack
            SliderTrack.Parent = Slider
            SliderValue.Parent = Slider
            SliderLabel.Parent = Slider
            Slider.Parent = TabContent
            
            return Slider
        end
        
        function Tab:CreateLabel(text)
            local Label = Instance.new("TextLabel")
            Label.Name = "Label"
            Label.Size = UDim2.new(1, 0, 0, 30)
            Label.BackgroundTransparency = 1
            Label.Text = text
            Label.TextColor3 = Window.Theme.TextSecondary
            Label.TextSize = 14
            Label.Font = Enum.Font.Gotham
            Label.TextXAlignment = Enum.TextXAlignment.Left
            
            Label.Parent = TabContent
            
            return Label
        end
        
        return Tab
    end
    
    function Window:Destroy()
        ScreenGui:Destroy()
    end
    
    return Window
end

-- Notification system
function CustomUILibrary:Notify(config)
    local Notification = Instance.new("Frame")
    Notification.Size = UDim2.new(0, 300, 0, 80)
    Notification.Position = UDim2.new(1, -320, 1, -100)
    Notification.BackgroundColor3 = DefaultTheme.Card
    Notification.BorderSizePixel = 0
    
    local UICorner = Instance.new("UICorner")
    UICorner.CornerRadius = UDim.new(0, 12)
    UICorner.Parent = Notification
    
    local UIStroke = Instance.new("UIStroke")
    UIStroke.Color = DefaultTheme.Surface
    UIStroke.Thickness = 2
    UIStroke.Parent = Notification
    
    local Title = Instance.new("TextLabel")
    Title.Size = UDim2.new(1, -20, 0, 25)
    Title.Position = UDim2.new(0, 15, 0, 15)
    Title.BackgroundTransparency = 1
    Title.Text = config.Title or "Notification"
    Title.TextColor3 = DefaultTheme.Text
    Title.TextSize = 16
    Title.Font = Enum.Font.GothamBold
    Title.TextXAlignment = Enum.TextXAlignment.Left
    
    local Message = Instance.new("TextLabel")
    Message.Size = UDim2.new(1, -20, 0, 35)
    Message.Position = UDim2.new(0, 15, 0, 40)
    Message.BackgroundTransparency = 1
    Message.Text = config.Message or ""
    Message.TextColor3 = DefaultTheme.TextSecondary
    Message.TextSize = 14
    Message.Font = Enum.Font.Gotham
    Message.TextXAlignment = Enum.TextXAlignment.Left
    Message.TextWrapped = true
    
    Notification.Parent = game.CoreGui
    Title.Parent = Notification
    Message.Parent = Notification
    
    -- Animate in
    Notification.Position = UDim2.new(1, 300, 1, -100)
    TweenService:Create(Notification, TweenInfo.new(0.3), {
        Position = UDim2.new(1, -320, 1, -100)
    }):Play()
    
    -- Auto remove after delay
    task.delay(config.Duration or 5, function()
        TweenService:Create(Notification, TweenInfo.new(0.3), {
            Position = UDim2.new(1, 300, 1, -100)
        }):Play()
        task.wait(0.3)
        Notification:Destroy()
    end)
end

return CustomUILibrary
